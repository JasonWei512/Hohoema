<ContentControl
    x:Class="NicoPlayerHohoema.Views.MenuNavigatePageBase"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:NicoPlayerHohoema.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:core="using:Microsoft.Xaml.Interactions.Core"
    xmlns:toolkit="using:WinRTXamlToolkit.Controls"
    xmlns:mvvm="using:Prism.Windows.Mvvm"
    xmlns:ext="using:WinRTXamlToolkit.Controls.Extensions"
    mvvm:ViewModelLocator.AutoWireViewModel="True"
    mc:Ignorable="d"
    d:DesignHeight="300"
    d:DesignWidth="400"    
    >

    <ContentControl.Resources>
        <DataTemplate x:Key="MenuItemTemplate">
            <StackPanel>
                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroup x:Name="MenuItemState">

                        <!-- 一番幅が広いとき -->
                        <VisualState>
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="1025" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                                <Setter Target="LabelTextBlock.Visibility" Value="Visible" />
                                <Setter Target="Icon.Height" Value="32" />
                                <Setter Target="Icon.Width" Value="32" />
                                <Setter Target="Icon.Margin" Value="8" />
                            </VisualState.Setters>
                        </VisualState>
                        <!-- 中ぐらい -->
                        <VisualState>
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="721" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                                <Setter Target="LabelTextBlock.Visibility" Value="Collapsed" />
                                <Setter Target="Icon.Height" Value="32" />
                                <Setter Target="Icon.Width" Value="32" />
                                <Setter Target="Icon.Margin" Value="0" />

                            </VisualState.Setters>
                        </VisualState>
                        <!-- 超狭い -->
                        <VisualState>
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="0" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                                <Setter Target="LabelTextBlock.Visibility" Value="Collapsed" />
                                <Setter Target="Icon.Height" Value="24" />
                                <Setter Target="Icon.Width" Value="24" />
                                <Setter Target="Icon.Margin" Value="0" />
                            </VisualState.Setters>
                        </VisualState>
                    </VisualStateGroup>
                </VisualStateManager.VisualStateGroups>

                <Border Background="Transparent" 
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    >


                    <!--
                <i:Interaction.Behaviors>
                    <core:EventTriggerBehavior EventName="Tapped">
                        <core:InvokeCommandAction Command="{Binding SelectedCommand}" />
                    </core:EventTriggerBehavior>
                </i:Interaction.Behaviors>
                -->
                    <StackPanel Orientation="Horizontal">

                        <SymbolIcon x:Name="Icon"
                                Symbol="{Binding IconType}"  
                                
                                Margin="8 0"
                        />

                        <TextBlock x:Name="LabelTextBlock"
                               Text="{Binding Label}" 
                               VerticalAlignment="Center"
                                   Margin="8 0"
                               />



                    </StackPanel>
                </Border>
            </StackPanel>
            
        </DataTemplate>
    </ContentControl.Resources>
    
    
    <ContentControl.Template>
        <ControlTemplate>

            <toolkit:DockPanel>


                <VisualStateManager.VisualStateGroups>
                    <VisualStateGroup x:Name="TopBarStateGroup">

                        <VisualState>
                            <VisualState.StateTriggers>
                                <StateTrigger IsActive="{Binding IsVisibleMenu.Value, Converter={StaticResource InvertBoolean}}" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                                <Setter Target="OpenPaneButton.Visibility" Value="Collapsed" />
                                <Setter Target="SplitView.DisplayMode" Value="Overlay" />
                                <Setter Target="SplitView.IsPaneOpen" Value="False" />
                            </VisualState.Setters>
                        </VisualState>
                        
                        <!-- 一番幅が広いとき -->
                        <VisualState>
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="1025" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                                <Setter Target="OpenPaneButton.Visibility" Value="Visible" />
                                <Setter Target="SplitView.DisplayMode" Value="Inline" />
                                <Setter Target="SplitView.IsPaneOpen" Value="True" />
                                
                            </VisualState.Setters>
                        </VisualState>
                        <!-- 中ぐらい -->
                        <VisualState>
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="721" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                                <Setter Target="OpenPaneButton.Visibility" Value="Visible" />
                                <Setter Target="SplitView.DisplayMode" Value="CompactOverlay" />
                            </VisualState.Setters>
                        </VisualState>
                        <!-- 超狭い -->
                        <VisualState>
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="0" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                                <Setter Target="OpenPaneButton.Visibility" Value="Visible" />
                                <Setter Target="SplitView.DisplayMode" Value="CompactOverlay" />
                            </VisualState.Setters>
                        </VisualState>
                    </VisualStateGroup>


                    <VisualStateGroup x:Name="PaneStateGroup">
                        <!-- 一番幅が広いとき -->
                        <VisualState>
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="1025" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                            </VisualState.Setters>
                        </VisualState>
                        <!-- 中ぐらい -->
                        <VisualState>
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="721" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                            </VisualState.Setters>
                        </VisualState>
                        <!-- 超狭い -->
                        <VisualState>
                            <VisualState.StateTriggers>
                                <AdaptiveTrigger MinWindowWidth="0" />
                            </VisualState.StateTriggers>
                            <VisualState.Setters>
                            </VisualState.Setters>
                        </VisualState>
                    </VisualStateGroup>

                    


                        
                        
                    
                </VisualStateManager.VisualStateGroups>

                <toolkit:DockPanel x:Name="TopBar" 
                                   toolkit:DockPanel.Dock="Top"
                                   Visibility="{Binding IsVisibleMenu.Value, Converter={StaticResource BooleanToVisibility}}"
                                   >
                    <AppBarButton
                          x:Name="OpenPaneButton"
                          Icon="OpenPane"
                          toolkit:DockPanel.Dock="Left"
                          Height="48"
                          >
                        <i:Interaction.Behaviors>
                            <core:EventTriggerBehavior EventName="Tapped">
                                <core:ChangePropertyAction TargetObject="{Binding ElementName=SplitView}"
                                                           PropertyName="IsPaneOpen"
                                                           Value="True"
                                                       />
                            </core:EventTriggerBehavior>
                        </i:Interaction.Behaviors>
                    </AppBarButton>

                    
                    <!-- Topbar Right-->
                    <StackPanel 
                                Orientation="Horizontal"
                                toolkit:DockPanel.Dock="Right"
                                >


                        <AppBarButton
                          Icon="Find"
                          toolkit:DockPanel.Dock="Left"
                          Height="48"
                          >
                            <i:Interaction.Behaviors>
                                <core:EventTriggerBehavior EventName="Tapped">
                                    <core:InvokeCommandAction Command="{Binding OpenSearchDialogCommand}" />
                                </core:EventTriggerBehavior>
                            </i:Interaction.Behaviors>
                        </AppBarButton>


                    </StackPanel>


                    <TextBlock x:Name="TopBarTitle"
                               Text="{Binding TitleText}"
                               VerticalAlignment="Center"
                               FontSize="24"
                               toolkit:DockPanel.Dock="Top"
                               Margin="16 0"
                               FontWeight="SemiLight"
                               >

                    </TextBlock>
                    
                    

                </toolkit:DockPanel>

                <SplitView x:Name="SplitView" 
                           CompactPaneLength="48"
                           DisplayMode="CompactInline"
                           OpenPaneLength="180"
                           >

                    
                    <SplitView.Pane>
                        <StackPanel>

                            <ListBox ItemsSource="{Binding MenuItems}"
                                      SelectionMode="Single"
                                      SelectedValue="{Binding SelectedItem.Value, Mode=TwoWay}"
                                      ItemTemplate="{StaticResource MenuItemTemplate}"
                                      >
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="Padding" Value="8 8" />
                                        <Setter Property="Margin" Value="0" />
                                    </Style>
                                </ListBox.ItemContainerStyle>
                                
                                <i:Interaction.Behaviors>
                                    <core:EventTriggerBehavior EventName="SelectionChanged">
                                        <core:ChangePropertyAction TargetObject="{Binding ElementName=SplitView}"
                                                                   PropertyName="IsPaneOpen"
                                                                   Value="False"
                                                                   />

                                    </core:EventTriggerBehavior>
                                </i:Interaction.Behaviors>
                            </ListBox>

                            <Border BorderBrush="Gray"
                                    BorderThickness="0 1 0 0" />

                            <ListBox ItemsSource="{Binding PersonalMenuItems}" 
                                      SelectionMode="Single"
                                      SelectedValue="{Binding SelectedItem.Value, Mode=TwoWay}"
                                      ItemTemplate="{StaticResource MenuItemTemplate}"
                                      
                                              >
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="Padding" Value="8 8" />
                                        <Setter Property="Margin" Value="0" />
                                    </Style>
                                </ListBox.ItemContainerStyle>

                                <i:Interaction.Behaviors>
                                    <core:EventTriggerBehavior EventName="SelectionChanged">
                                        <core:ChangePropertyAction TargetObject="{Binding ElementName=SplitView}"
                                                                   PropertyName="IsPaneOpen"
                                                                   Value="False"
                                                                   />

                                    </core:EventTriggerBehavior>
                                </i:Interaction.Behaviors>
                            </ListBox>

                        </StackPanel>
                    </SplitView.Pane>
                    <SplitView.Content>

                        <toolkit:DockPanel>

                            <ContentPresenter />

                        </toolkit:DockPanel>
                    </SplitView.Content>
                </SplitView>

            </toolkit:DockPanel>
            
        </ControlTemplate>
    </ContentControl.Template>
</ContentControl>
